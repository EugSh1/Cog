"use strict";(self.webpackChunkcog_http_docs=self.webpackChunkcog_http_docs||[]).push([[695],{6101:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>i,contentTitle:()=>c,default:()=>h,frontMatter:()=>d,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"benchmark","title":"Benchmark","description":"We compared Cog (1.0.4), Hono (4.7.10) & @hono/node-server (1.14.1) and Express (5.1.0)","source":"@site/docs/benchmark.md","sourceDirName":".","slug":"/benchmark","permalink":"/Cog/docs/benchmark","draft":false,"unlisted":false,"editUrl":"https://github.com/EugSh1/Cog/tree/main/docs/docs/benchmark.md","tags":[],"version":"current","frontMatter":{"title":"Benchmark"},"sidebar":"tutorialSidebar","previous":{"title":"Congratulations!","permalink":"/Cog/docs/tutorial-basics/congratulations"},"next":{"title":"Working with cookies","permalink":"/Cog/docs/working-with-cookies"}}');var t=s(4848),o=s(8453);const d={title:"Benchmark"},c="Benchmark",i={},l=[{value:"Results",id:"results",level:2},{value:"Summary",id:"summary",level:2},{value:"Apps code",id:"apps-code",level:2},{value:"Cog app",id:"cog-app",level:3},{value:"Hono app",id:"hono-app",level:3},{value:"Express app",id:"express-app",level:3}];function a(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,o.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"benchmark",children:"Benchmark"})}),"\n",(0,t.jsxs)(n.p,{children:["We compared ",(0,t.jsx)(n.strong,{children:"Cog (1.0.4)"}),", ",(0,t.jsx)(n.strong,{children:"Hono (4.7.10) & @hono/node-server (1.14.1)"})," and ",(0,t.jsx)(n.strong,{children:"Express (5.1.0)"}),"\nusing ",(0,t.jsx)(n.a,{href:"https://www.npmjs.com/package/autocannon",children:"autocannon"})," with the following code:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:'import autocannon from "autocannon";\n\nconst PORT = 3000;\n\nconst routes = [\n    "/",\n    "/very/deeply/nested/route/hello/there/admin/dashboard/ping",\n    "/hello?name=John",\n    "/admin",\n    "/admin/set-token",\n    "/parse-body"\n] as const;\n\nfor (const route of routes) {\n    console.log(`\\n--- Benchmarking ${route} ---`);\n    const result = await autocannon({\n        url: `http://127.0.0.1:${PORT}${route}`,\n        connections: 800,\n        duration: 10,\n        method: route === "/parse-body" ? "POST" : "GET",\n        headers:\n            route === "/parse-body"\n                ? { "Content-Type": "application/json" }\n                : { cookie: "sessionId=abc123; otherCookie=value" },\n        body: route === "/parse-body" ? JSON.stringify({ message: "Hello!" }) : undefined\n    });\n\n    console.log(`Completed benchmark for ${route}`);\n    console.log(`Requests/sec: ${result.requests.average}`);\n    console.log(`Latency (avg): ${result.latency.average} ms`);\n    console.log(`Errors: ${result.errors}`);\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"results",children:"Results"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Route"}),(0,t.jsx)(n.th,{children:"Framework"}),(0,t.jsx)(n.th,{children:"Requests/sec"}),(0,t.jsx)(n.th,{children:"Latency (avg)"}),(0,t.jsx)(n.th,{children:"Errors"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"/"})}),(0,t.jsx)(n.td,{children:"Hono"}),(0,t.jsx)(n.td,{children:"62514.91"}),(0,t.jsx)(n.td,{children:"12.29 ms"}),(0,t.jsx)(n.td,{children:"0"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{}),(0,t.jsx)(n.td,{children:"Cog"}),(0,t.jsx)(n.td,{children:"49764.37"}),(0,t.jsx)(n.td,{children:"15.58 ms"}),(0,t.jsx)(n.td,{children:"0"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{}),(0,t.jsx)(n.td,{children:"Express"}),(0,t.jsx)(n.td,{children:"14745.1"}),(0,t.jsx)(n.td,{children:"39.71 ms"}),(0,t.jsx)(n.td,{children:"226"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"/very/deeply..."})}),(0,t.jsx)(n.td,{children:"Hono"}),(0,t.jsx)(n.td,{children:"60312.73"}),(0,t.jsx)(n.td,{children:"12.84 ms"}),(0,t.jsx)(n.td,{children:"0"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{}),(0,t.jsx)(n.td,{children:"Cog"}),(0,t.jsx)(n.td,{children:"48344.73"}),(0,t.jsx)(n.td,{children:"16.04 ms"}),(0,t.jsx)(n.td,{children:"0"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{}),(0,t.jsx)(n.td,{children:"Express"}),(0,t.jsx)(n.td,{children:"14788"}),(0,t.jsx)(n.td,{children:"38.43 ms"}),(0,t.jsx)(n.td,{children:"251"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"/hello?name=John"})}),(0,t.jsx)(n.td,{children:"Hono"}),(0,t.jsx)(n.td,{children:"61473.46"}),(0,t.jsx)(n.td,{children:"12.53 ms"}),(0,t.jsx)(n.td,{children:"0"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{}),(0,t.jsx)(n.td,{children:"Cog"}),(0,t.jsx)(n.td,{children:"48082.91"}),(0,t.jsx)(n.td,{children:"16.06 ms"}),(0,t.jsx)(n.td,{children:"0"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{}),(0,t.jsx)(n.td,{children:"Express"}),(0,t.jsx)(n.td,{children:"14464.37"}),(0,t.jsx)(n.td,{children:"38.46 ms"}),(0,t.jsx)(n.td,{children:"263"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"/admin"})}),(0,t.jsx)(n.td,{children:"Hono"}),(0,t.jsx)(n.td,{children:"41037.1"}),(0,t.jsx)(n.td,{children:"18.99 ms"}),(0,t.jsx)(n.td,{children:"0"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{}),(0,t.jsx)(n.td,{children:"Cog"}),(0,t.jsx)(n.td,{children:"48856.73"}),(0,t.jsx)(n.td,{children:"15.95 ms"}),(0,t.jsx)(n.td,{children:"0"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{}),(0,t.jsx)(n.td,{children:"Express"}),(0,t.jsx)(n.td,{children:"14196.73"}),(0,t.jsx)(n.td,{children:"38.82 ms"}),(0,t.jsx)(n.td,{children:"267"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"/admin/set-token"})}),(0,t.jsx)(n.td,{children:"Hono"}),(0,t.jsx)(n.td,{children:"38922.19"}),(0,t.jsx)(n.td,{children:"20.06 ms"}),(0,t.jsx)(n.td,{children:"0"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{}),(0,t.jsx)(n.td,{children:"Cog"}),(0,t.jsx)(n.td,{children:"47451.64"}),(0,t.jsx)(n.td,{children:"16.3 ms"}),(0,t.jsx)(n.td,{children:"0"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{}),(0,t.jsx)(n.td,{children:"Express"}),(0,t.jsx)(n.td,{children:"13982.4"}),(0,t.jsx)(n.td,{children:"37.26 ms"}),(0,t.jsx)(n.td,{children:"272"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"/parse-body"})}),(0,t.jsx)(n.td,{children:"Hono"}),(0,t.jsx)(n.td,{children:"26339.64"}),(0,t.jsx)(n.td,{children:"29.06 ms"}),(0,t.jsx)(n.td,{children:"124"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{}),(0,t.jsx)(n.td,{children:"Cog"}),(0,t.jsx)(n.td,{children:"47324.8"}),(0,t.jsx)(n.td,{children:"16.35 ms"}),(0,t.jsx)(n.td,{children:"0"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{}),(0,t.jsx)(n.td,{children:"Express"}),(0,t.jsx)(n.td,{children:"12873.1"}),(0,t.jsx)(n.td,{children:"40.15 ms"}),(0,t.jsx)(n.td,{children:"293"})]})]})]}),"\n",(0,t.jsx)(n.h2,{id:"summary",children:"Summary"}),"\n",(0,t.jsxs)(n.p,{children:["The benchmarks show that ",(0,t.jsx)(n.strong,{children:"Hono"})," delivers the highest requests per second and the lowest latency on\nmost routes, except for ",(0,t.jsx)(n.code,{children:"/admin"})," and ",(0,t.jsx)(n.code,{children:"/admin/set-token"}),", where ",(0,t.jsx)(n.strong,{children:"Cog"})," performs slightly better in\nspeed and latency."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Cog"})," shows zero errors but its performance is generally lower than Hono's, and given the context,\nit should not be considered a reliable choice for production use."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Express"})," performs significantly worse in all metrics, with much higher latency, fewer requests\nper second, and many errors across all routes."]}),"\n",(0,t.jsxs)(n.p,{children:["In summary, ",(0,t.jsx)(n.strong,{children:"Hono"})," offers the best performance overall, ",(0,t.jsx)(n.strong,{children:"Cog"})," is not recommended for production\ndespite zero errors, and ",(0,t.jsx)(n.strong,{children:"Express"})," lags behind in speed and reliability."]}),"\n",(0,t.jsx)(n.admonition,{type:"caution",children:(0,t.jsx)(n.p,{children:"All benchmarks were run locally with Node.js v22.11.0 on a MacBook Air M1. Also, these tests were\nconducted by someone whose benchmarking skills are... let\u2019s say, \u201centhusiastic beginner,\u201d so results\nmay differ if rerun or done by a pro."})}),"\n",(0,t.jsx)(n.h2,{id:"apps-code",children:"Apps code"}),"\n",(0,t.jsx)(n.h3,{id:"cog-app",children:"Cog app"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:'import { Cog } from "cog-http";\n\nconst app = new Cog();\n\napp.use("*", (_req, res, next) => {\n    res.set("X-Powered-By", "Cog");\n    next();\n});\n\napp.get("/", (_req, res) => {\n    res.send("Hello from Cog!");\n});\n\napp.get("/very/deeply/nested/route/hello/there/admin/dashboard/ping", (_req, res) => {\n    res.send("Pong!");\n});\n\napp.get("/hello", (req, res) => {\n    const { name } = req.query;\n    res.send(`Hello, ${name || "user"}!`);\n});\n\napp.group("/admin", (admin) => {\n    admin.get("/", (req, res) => {\n        const { token } = req.cookies;\n\n        if (token === "my_token_12345") {\n            res.clearCookie("token");\n            return res.send({ message: "Secret info" });\n        }\n\n        res.send("Unauthenticated", 403);\n    });\n\n    admin.get("/set-token", (_req, res) => {\n        res.setCookie("token", "my_token_12345");\n        res.send("Token set!");\n    });\n});\n\napp.post("/parse-body", (req, res) => {\n    const body = req.body;\n    res.send(body);\n});\n\napp.listen(3000, "127.0.0.1", () => {\n    console.log("Listening on 127.0.0.1:3000");\n});\n'})}),"\n",(0,t.jsx)(n.h3,{id:"hono-app",children:"Hono app"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:'import { Hono } from "hono";\nimport { serve } from "@hono/node-server";\nimport { getCookie, setCookie, deleteCookie } from "hono/cookie";\n\nconst app = new Hono();\n\napp.use("*", async (c, next) => {\n    c.header("X-Powered-By", "Hono");\n    await next();\n});\n\napp.get("/", (c) => c.text("Hello from Hono!"));\n\napp.get("/very/deeply/nested/route/hello/there/admin/dashboard/ping", (c) => c.text("Pong!"));\n\napp.get("/hello", (c) => {\n    const name = c.req.query("name") || "user";\n    return c.text(`Hello, ${name}!`);\n});\n\nconst admin = new Hono();\n\nadmin.get("/", (c) => {\n    const token = getCookie(c, "token");\n    if (token === "my_token_12345") {\n        deleteCookie(c, "token");\n        return c.json({ message: "Secret info" });\n    }\n    return c.text("Unauthenticated", 403);\n});\n\nadmin.get("/set-token", (c) => {\n    setCookie(c, "token", "my_token_12345");\n    return c.text("Token set!");\n});\n\napp.route("/admin/*", admin);\n\napp.post("/parse-body", async (c) => {\n    const body = await c.req.json();\n    return c.json(body);\n});\n\nserve({\n    fetch: app.fetch,\n    hostname: "127.0.0.1",\n    port: 3002\n});\nconsole.log("Listening on 127.0.0.1:3002");\n'})}),"\n",(0,t.jsx)(n.h3,{id:"express-app",children:"Express app"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:'import express from "express";\nimport cookieParser from "cookie-parser";\n\nconst app = express();\n\napp.use(cookieParser());\napp.use(express.json() as express.RequestHandler);\n\napp.use((_req, res, next) => {\n    res.set("X-Powered-By", "Express");\n    next();\n});\n\napp.get("/", (_req, res) => {\n    res.send("Hello from Express!");\n});\n\napp.get("/very/deeply/nested/route/hello/there/admin/dashboard/ping", (_req, res) => {\n    res.send("Pong!");\n});\n\napp.get("/hello", (req, res) => {\n    const { name } = req.query;\n    res.send(`Hello, ${name || "user"}!`);\n});\n\nconst adminRouter = express.Router();\n\nadminRouter.get("/", (req, res) => {\n    const { token } = req.cookies;\n    if (token === "my_token_12345") {\n        res.clearCookie("token");\n        res.status(200).send({ message: "Secret info" });\n        return;\n    }\n    res.status(403).send("Unauthenticated");\n});\n\nadminRouter.get("/set-token", (_req, res) => {\n    res.cookie("token", "my_token_12345");\n    res.send("Token set!");\n});\n\napp.use("/admin", adminRouter);\n\napp.post("/parse-body", (req, res) => {\n    res.send(req.body);\n});\n\napp.listen(3001, "127.0.0.1", () => {\n    console.log("Express listening on 127.0.0.1:3001");\n});\n'})})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(a,{...e})}):a(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>d,x:()=>c});var r=s(6540);const t={},o=r.createContext(t);function d(e){const n=r.useContext(o);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:d(e.components),r.createElement(o.Provider,{value:n},e.children)}}}]);